<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation - Advanced Telegram Bot</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/prism@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .docs-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            margin: 2rem 0;
        }
        .endpoint-card {
            border: 2px solid #e9ecef;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }
        .endpoint-card:hover {
            border-color: #007bff;
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.1);
        }
        .method-badge {
            font-weight: 600;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
        }
        .method-get { background: #28a745; color: white; }
        .method-post { background: #ffc107; color: #000; }
        .method-put { background: #17a2b8; color: white; }
        .method-delete { background: #dc3545; color: white; }
        .code-block {
            background: #2d3748;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .response-example {
            max-height: 300px;
            overflow-y: auto;
        }
        .sidebar {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1.5rem;
            position: sticky;
            top: 2rem;
        }
        .nav-link {
            color: #495057;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }
        .nav-link:hover, .nav-link.active {
            background: #007bff;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-lg-3">
                <div class="sidebar">
                    <h5 class="mb-3"><i class="bi bi-book me-2"></i>API Documentation</h5>
                    <nav class="nav flex-column">
                        <a class="nav-link active" href="#overview">Overview</a>
                        <a class="nav-link" href="#dashboard">Dashboard</a>
                        <a class="nav-link" href="#status">Status API</a>
                        <a class="nav-link" href="#health">Health Check</a>
                        <a class="nav-link" href="#metrics">Metrics</a>
                        <a class="nav-link" href="#webhook">Webhook</a>
                        <a class="nav-link" href="#auth">Authentication</a>
                        <a class="nav-link" href="#errors">Error Handling</a>
                    </nav>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-lg-9">
                <div class="docs-container p-4">
                    <!-- Overview -->
                    <section id="overview" class="mb-5">
                        <h1 class="mb-4">
                            <i class="bi bi-robot text-primary me-3"></i>
                            Advanced Telegram Bot API
                        </h1>
                        <p class="lead">
                            Complete API documentation for the Advanced Telegram Bot with Gemini AI integration.
                            This bot provides AI-powered conversations, image generation, and analysis capabilities.
                        </p>
                        
                        <div class="row mt-4">
                            <div class="col-md-6">
                                <div class="card border-0 bg-light">
                                    <div class="card-body">
                                        <h6><i class="bi bi-server text-primary me-2"></i>Base URL</h6>
                                        <code>http://localhost:5000</code>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card border-0 bg-light">
                                    <div class="card-body">
                                        <h6><i class="bi bi-file-code text-success me-2"></i>Response Format</h6>
                                        <code>application/json</code>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Dashboard -->
                    <section id="dashboard" class="mb-5">
                        <h2 class="mb-3">Dashboard Endpoints</h2>
                        
                        <div class="endpoint-card">
                            <div class="card-header bg-transparent">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">Interactive Dashboard</h5>
                                    <span class="method-badge method-get">GET</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <p><strong>Endpoint:</strong> <code>/</code> or <code>/dashboard</code></p>
                                <p>Returns a beautiful, interactive dashboard with real-time bot statistics, 
                                   system monitoring, and API endpoint documentation.</p>
                                
                                <h6>Features:</h6>
                                <ul>
                                    <li>Real-time bot statistics</li>
                                    <li>Uptime and performance metrics</li>
                                    <li>Interactive charts and progress bars</li>
                                    <li>Auto-refresh functionality</li>
                                    <li>Responsive design for all devices</li>
                                </ul>

                                <h6>Example Request:</h6>
                                <div class="code-block">
                                    <pre><code class="language-bash">curl http://localhost:5000/</code></pre>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Status API -->
                    <section id="status" class="mb-5">
                        <h2 class="mb-3">Status API</h2>
                        
                        <div class="endpoint-card">
                            <div class="card-header bg-transparent">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">Bot Status</h5>
                                    <span class="method-badge method-get">GET</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <p><strong>Endpoint:</strong> <code>/status</code></p>
                                <p>Returns comprehensive bot status information including uptime, 
                                   statistics, and configuration details.</p>

                                <h6>Example Request:</h6>
                                <div class="code-block">
                                    <pre><code class="language-bash">curl -H "Accept: application/json" http://localhost:5000/status</code></pre>
                                </div>

                                <h6>Response Example:</h6>
                                <div class="code-block response-example">
                                    <pre><code class="language-json">{
    "status": "online",
    "uptime_seconds": 3600,
    "uptime_formatted": "1h 0m",
    "statistics": {
        "messages_processed": 150,
        "images_analyzed": 25,
        "images_generated": 12,
        "errors": 2,
        "active_users": 8
    },
    "bot_info": {
        "bot_username": "GeminiAIBot",
        "admin_id": 123456789,
        "max_message_length": 4096,
        "webhook_configured": false,
        "allowed_image_types": ["image/jpeg", "image/png", "image/webp"]
    },
    "timestamp": "2025-08-11T17:42:39.123456"
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Health Check -->
                    <section id="health" class="mb-5">
                        <h2 class="mb-3">Health Check</h2>
                        
                        <div class="endpoint-card">
                            <div class="card-header bg-transparent">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">Health Status</h5>
                                    <span class="method-badge method-get">GET</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <p><strong>Endpoint:</strong> <code>/health</code></p>
                                <p>Simple health check endpoint for monitoring systems. Returns the health 
                                   status of core services including bot, Gemini API, and Telegram API.</p>

                                <h6>Example Request:</h6>
                                <div class="code-block">
                                    <pre><code class="language-bash">curl http://localhost:5000/health</code></pre>
                                </div>

                                <h6>Response Example:</h6>
                                <div class="code-block">
                                    <pre><code class="language-json">{
    "status": "healthy",
    "timestamp": "2025-08-11T17:42:39.123456",
    "services": {
        "bot": "running",
        "gemini_api": "configured",
        "telegram_api": "configured"
    }
}</code></pre>
                                </div>

                                <div class="alert alert-info mt-3">
                                    <i class="bi bi-info-circle me-2"></i>
                                    <strong>Monitoring Tip:</strong> Use this endpoint for uptime monitoring 
                                    and automated health checks in your deployment pipeline.
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Metrics -->
                    <section id="metrics" class="mb-5">
                        <h2 class="mb-3">Metrics API</h2>
                        
                        <div class="endpoint-card">
                            <div class="card-header bg-transparent">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">Performance Metrics</h5>
                                    <span class="method-badge method-get">GET</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <p><strong>Endpoint:</strong> <code>/metrics</code></p>
                                <p>Returns detailed performance metrics suitable for monitoring tools 
                                   like Prometheus, Grafana, or custom monitoring solutions.</p>

                                <h6>Example Request:</h6>
                                <div class="code-block">
                                    <pre><code class="language-bash">curl http://localhost:5000/metrics</code></pre>
                                </div>

                                <h6>Response Example:</h6>
                                <div class="code-block">
                                    <pre><code class="language-json">{
    "uptime_seconds": 3600,
    "messages_total": 150,
    "images_analyzed_total": 25,
    "images_generated_total": 12,
    "errors_total": 2,
    "active_users": 8,
    "context_size_total": 45
}</code></pre>
                                </div>
                            </div>
                        </div>

                        <div class="endpoint-card">
                            <div class="card-header bg-transparent">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">Stats Summary</h5>
                                    <span class="method-badge method-get">GET</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <p><strong>Endpoint:</strong> <code>/api/stats/summary</code></p>
                                <p>Simplified statistics endpoint with calculated metrics and rates.</p>

                                <h6>Response Fields:</h6>
                                <ul>
                                    <li><code>online</code>: Boolean status</li>
                                    <li><code>uptime_hours</code>: Uptime in decimal hours</li>
                                    <li><code>error_rate</code>: Error percentage (0-100)</li>
                                    <li><code>total_images_processed</code>: Combined analysis + generation</li>
                                </ul>
                            </div>
                        </div>
                    </section>

                    <!-- Webhook -->
                    <section id="webhook" class="mb-5">
                        <h2 class="mb-3">Webhook Endpoint</h2>
                        
                        <div class="endpoint-card">
                            <div class="card-header bg-transparent">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0">Telegram Webhook</h5>
                                    <span class="method-badge method-post">POST</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <p><strong>Endpoint:</strong> <code>/webhook</code></p>
                                <p>Receives Telegram webhook updates when configured. Currently used 
                                   for webhook mode operation (alternative to polling).</p>

                                <div class="alert alert-warning">
                                    <i class="bi bi-exclamation-triangle me-2"></i>
                                    <strong>Note:</strong> Currently the bot runs in polling mode. 
                                    To use webhooks, configure WEBHOOK_URL environment variable.
                                </div>

                                <h6>Webhook Setup:</h6>
                                <div class="code-block">
                                    <pre><code class="language-bash"># Set webhook URL
export WEBHOOK_URL="https://your-domain.com/webhook"

# Telegram will POST updates to this endpoint</code></pre>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Authentication -->
                    <section id="auth" class="mb-5">
                        <h2 class="mb-3">Authentication</h2>
                        
                        <div class="alert alert-info">
                            <i class="bi bi-info-circle me-2"></i>
                            <strong>Current Status:</strong> All API endpoints are publicly accessible. 
                            For production use, consider implementing API key authentication.
                        </div>

                        <h6>Security Features:</h6>
                        <ul>
                            <li>Admin-only bot commands (verified by Telegram user ID)</li>
                            <li>Rate limiting on bot interactions (10 msgs/min per user)</li>
                            <li>Input validation for all user inputs</li>
                            <li>Secure environment variable handling</li>
                        </ul>
                    </section>

                    <!-- Error Handling -->
                    <section id="errors" class="mb-5">
                        <h2 class="mb-3">Error Handling</h2>
                        
                        <h6>Standard HTTP Status Codes:</h6>
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Code</th>
                                        <th>Description</th>
                                        <th>Example</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><span class="badge bg-success">200</span></td>
                                        <td>Success</td>
                                        <td>Normal API response</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-warning">404</span></td>
                                        <td>Not Found</td>
                                        <td>Invalid endpoint</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-danger">500</span></td>
                                        <td>Server Error</td>
                                        <td>Bot service unavailable</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-secondary">503</span></td>
                                        <td>Service Unavailable</td>
                                        <td>Bot not initialized</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h6>Error Response Format:</h6>
                        <div class="code-block">
                            <pre><code class="language-json">{
    "error": "Service unavailable",
    "message": "Bot is currently offline",
    "timestamp": "2025-08-11T17:42:39.123456",
    "endpoint": "/status"
}</code></pre>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prism@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prism@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <script>
        // Smooth scrolling for navigation
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    
                    // Update active nav link
                    document.querySelectorAll('.nav-link').forEach(link => {
                        link.classList.remove('active');
                    });
                    this.classList.add('active');
                }
            });
        });

        // Highlight code blocks
        Prism.highlightAll();
    </script>
</body>
</html>
